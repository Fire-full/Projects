Class "Profile";


  Import СИС2 Classes Константы, Переменные, Функции;
  --Import Classes Константы;


InClass Public

  proc Init;
    var локВерсияПроектаИзИнформационнойБазы :Numeric;

    if ПроцессЗагрузкиПрерван then
      return;
    end;

    if НоваяИнформационнаяБазаДляПроекта(ClassProject, ИмяВерсииПроекта,
      ПолучитьВерсиюПроекта, локВерсияПроектаИзИнформационнойБазы) then
      try
        ПроверитьКритичныеНастройки;
        -- **************** блок конвертации старых данных ******************************
        -- пожалуйста, ставьте дату внесения изменений, чтобы можно было вовремя удалять конвертацию
        -- *******************************************************************************


        -- **************** блок конвертации старых данных ******************************
        -- пожалуйста, ставьте дату внесения изменений, чтобы можно было вовремя удалять конвертацию
        -- *******************************************************************************
        УстановитьНовуюВерсиюИнформационннойБазыДляПроекта(ИмяВерсииПроекта, ПолучитьВерсиюПроекта);
      except
        Message('Ошибка при конвертации.');
      end;
    end;
  end;


  proc GetSessionInfo;
    AddSessionInfo(ЗаголовокИнформацииОРелизах, 'Версия проекта '+ClassProject+' : '+Str(ПолучитьВерсиюПроекта, '0.000'));
  end;

  --ФОЕ--
  Проц ВыводСвойствОбъекта2 0(лок: Строка);
    var I, Z,X,Y     : Целое;
    var vMember    : FieldInfo;
    var vResType   : TypeInfo;
    var локСтрок   : Строка  ;
    var СтрокВыв   : Строка  ;
    var локЗапись  : ClassInfo ;
    var vClass     : Class;

      локСтрок  = "_______________"+лок+"_______________";
      vClass    = НайтиКласс( ПодСтр(лок,2,Длина(лок)-2) );
      if vClass    = nil then
        ВОЗВРАТ;
      end;
      локЗапись = vClass.ClassInfo;
      Z         =  Ядро.Запись.ClassInfo.MembersCount;
      X         =  локЗапись.MembersCount;
      Y         =  IF(Z>X, 1, Z);
      for I = Y .. X do
         СтрокВыв = "Тип:"+Стр(локЗапись.Member[I]) +"               "+ локЗапись.Member[I].Name ;
         локСтрок = локСтрок + Chr(13) + Chr(10) + СтрокВыв;
        if (локЗапись.Member[I] есть FieldInfo) then
          vMember  = локЗапись.Member[I] as FieldInfo;
          vResType = vMember.ResultType;
          if vResType is ClassInfo then
             if vResType is RecordClassInfo then
                 локСтрок = локСтрок + Chr(13) + Chr(10) + "               " +  vMember.Name;
             elsif vResType is SubtableClassInfo then
                 локСтрок = локСтрок + Chr(13) + Chr(10) + "               " +  vMember.Name;
             elsif vResType is StructureClassInfo then
                 локСтрок = локСтрок + Chr(13) + Chr(10) + "               " +  vMember.Name;
             end;
          else
                 локСтрок = локСтрок + Chr(13) + Chr(10) + "               " +  vMember.Name;
          end;
        end;
      end;
      Сообщение(локСтрок);
  end;
  --ФОЕ--
---------------------------------------------------------

InClass Private


  proc ПроверитьКритичныеНастройки;

  end;


End
