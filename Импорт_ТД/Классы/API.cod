class "Win API - функции";

inclass
РазделительДробнойЧастиСистемный  : String = "." ;  -- Нужно Будет найти АПИ
--НАЧАЛО ПРИМЕРА!!!!!!
-------------------------------------------------------------------------------------------------------------------------------------------------
external func GetUserName Синоним ИмяПользователяWin (var lpBuffer : String ; var nSize : Integer ) : Boolean ;  library "advapi32" name "GetUserNameA";
-------------------------------------------------------------------------------------------------------------------------------------------------
--Вызов Функции определяющей имя Комп.
ИмяКомпьютераВСети :String ;
--!!!!!!!!!!
функ UserName :String ;
  var vStr :String;
  var vLen :Integer;
    vLen = 255;
    vStr = RepStr(" ",vLen);
      if GetUserName(vStr, vLen) then
        ИмяКомпьютераВСети = Trim(vStr);
      end;
  ВОЗВРАТ ИмяКомпьютераВСети ;
end;
-------------------------------------------------------------------------------------------------------------------------------------------------
 --SDecimal : GetLocaleInformation(LOCALE_SDECIMAL)[1];
-------------------------------------------------------------------------------------------------------------------------------------------------
--Конец примера!!!!
--!!!!!!!!!!
функ ЕстьПодключение : Логическое ;
  var objShell      : AutoObject;
  var objFolder     : AutoObject;
  var Текст         : Строка;
  var vLen          :Integer;

    objShell  = AutoObject.Create ("WScript.Shell");
    objFolder = objShell.  Exec   ("ping.exe -n 1 vk.com" );

    --Вар. 1.
    --Нет открытия окна, но не ясно подключено к Инету или нет...
--    vLen            = objShell.Run("ping.exe vk.com -n 1 -w 4000 > nul", 0, 2 );
--    If vLen>=1 Тогда
--      objShell      = Nil;
--      objFolder     = Nil;
--      objFolderItem = Nil;
--      ВОЗВРАТ Истина;
--    end;

    --Вар. 2.
    --Есть открытия окна, но ясно, что подключено!!!
    Текст         = objFolder.StdOut.ReadAll;       --!!!!
--    Текст         = objFolder.StdOut.Read(6);     --!!!!

    objShell      = Nil;
    objFolder     = Nil;

    If Match(Текст, "*ttl=*") Тогда
      ВОЗВРАТ Истина;
    end;


  ВОЗВРАТ Ложь;
конец;
-------------------------------------------------------------------------------------------------------------------------------------------------
inobject

end