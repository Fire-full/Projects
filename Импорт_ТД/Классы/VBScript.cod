class "ScriptControl";  -- "MSScriptControl.ScriptControl"


inclass Public

var ScrptCtrl : AutoObject;
var Text      : Строка;

--------------------------------------------------------------------------------
функ FulFill : Логическое;   --Выполнить 1скрипт-0код1 без возврата каких-либо данных. К примеру: "Формат Диска С:\"
  var Рез   : Логическое;
    Рез = Истина;
      Попытка
        ScrptCtrl.addcode( Text );
      Исключение
        ScrptCtrl = NIL;
        Рез       = Ложь;
      end;
  Возврат Рез;
конец;
--------------------------------------------------------------------------------
функ Run(Show:Строка) : Вариант;1     -- Выполняет Функцию в скрипте и возвращает требуемое нам значение.
  var Рез : Вариант;1                 -- К примеру:0 1Выполняется Функция = "Формат Диска С:\" а возвращает "Да, диск отформатирован!" или "Нет!"

      Рез     = nil;
      if Script_Create then
        Рез = ScrptCtrl.Run(Show);
      ELSE
        Рез = nil;
      end;
      ScrptCtrl = nil;
      Text      = "" ;

  Возврат Рез;
конец;
--------------------------------------------------------------------------------
функ Eval(ResStr:Строка) :Вариант; 1  0 1-- Выполняет скрипт и возвращает требуемое нам значение.
  var Рез   : Вариант;                1-- К примеру:0 1 возвращает "Да, диск отформатирован!" или "Нет!"

      if Script_Create then
        Рез = ScrptCtrl.Eval(ResStr);
      ELSE
        Рез = nil;
      end;
      ScrptCtrl = nil;
      Text      = "" ;

  Возврат Рез;
конец;
--------------------------------------------------------------------------------
функ Run_Eval(Show:Строка; ResStr:Строка) :Вариант ;  1-- Выполняет Функцию в скрипте и возвращает требуемое нам значение.
  var Рез      : Вариант     ;                        1-- К примеру:0 1Выполняется Функция = "Формат Диска С:\" а возвращает "Время форматирования!"

      if Script_Create then
              ScrptCtrl.Run (  Show  );
        Рез = ScrptCtrl.Eval( ResStr );
      ELSE
        Рез = nil;
      end;
      ScrptCtrl = nil;
      Text      = "" ;

  Возврат Рез;
конец;
--------------------------------------------------------------------------------
функ Script_Create : Логическое;1   --Сервисная Функция. Пользователями не используемая!
  var Рез   : Логическое;

      Попытка
        ScrptCtrl          =  AutoObject.OpenOrCreate("MSScriptControl.ScriptControl", ИСТИНА);
        ScrptCtrl.Language = "vbscript";
        if FulFill then
          Рез = Истина;
        ELSE
          Рез = Ложь;
        end;
      Исключение
        ScrptCtrl = NIL;
        Рез       = Ложь;
        Сообщение("Ошибка выполнения - 'vbscript'.");
      end;

  Возврат Рез;
конец;
--------------------------------------------------------------------------------
end