Class inherited 2МашинаРеквизитов.Базовые.редБазовыйДокумент0 "Бланк  ", editor 2Импорт_ТД.Импорт_ТД.зап0Маркёры;
----------------------------------------------------------------------------
----------------------------------------------------------------------------
Перем МКД1 :Строка;
Перем МКД2 :Строка;
Перем МКД3 :Строка;
------------------------------------------------
  проц шаблон_ПриОткрытии(Создается :Логическое);
    унаследованный шаблон_ПриОткрытии(Создается);
    -- Вызывается при открытия окна формы
    --   Create: Истина - форма открывается, Ложь - форма восстанавливается при запуске сессии

    МКД1   = "";
    МКД2   = "";
    МКД3   = "";

    ЕСЛИ   Откуда = 1 ТОГДА
           МКД1   = МКД;
    ЕслиЖе Откуда = 2  ТОГДА
           Откуда = 2;
           МКД2   = МКД;
    ЕслиЖе Откуда = 3  ТОГДА
           Откуда = 3;
           Откуда = 2;
           МКД3   = МКД;
    ИЛСЕ;
     
  конец;
------------------------------------------------
  проц ПолеВвода_ПриВыходе(Клетка :КлеткаШаблона; Индекс :Целое);
    унаследованный ПолеВвода_ПриВыходе(Клетка, Индекс);
    -- Обработка события выхода из редактируемого поля
    -- Параметры:
    --   Cell: клетка шаблона
    --   Index: номер кадра, в котором находится клетка

    ЕСЛИ    Клетка.Содержимое  = "МКД1"  ТОГДА
           Откуда = 1;
           МКД    = Клетка.Значение;
           МКД2   = "";
           МКД3   = "";
    ЕслиЖе  Клетка.Содержимое  = "МКД2"  ТОГДА
           Откуда = 2;
           МКД    = Клетка.Значение;
           МКД1   = "";
           МКД3   = "";
    ЕслиЖе  Клетка.Содержимое  = "МКД3"  ТОГДА
           Откуда = 3;
           МКД    = Клетка.Значение;
           МКД2   = "";
           МКД1   = "";
    ИЛСЕ;

  конец;








----------------------------------------------------------------------------
END

