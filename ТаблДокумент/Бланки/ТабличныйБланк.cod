Class inherited СИС2.БазовыйБланк "Табличный Документ" ;

InClass Public

--{ Обработчики событий Class-а бланка

ЗаголовокОкнаФормы : Строка;

фрПриемник         : TemplateFrame;     -- Приемник
фрЗаголовок        : TemplateFrame;     -- Заголовок

секСлужебная       : TemplateSection;   -- Кнопочная секция("Печать","Настройка Печати","Предварительный Просмотр", ...)
секПриемник        : TemplateSection;   -- Секция Приемник

--------------------------------------------------------------------------------
  func Create :ТаблДокумент.ТабличныйБланк;
    Result  = inherited Create;
  end;
--------------------------------------------------------------------------------
--} Обработчики событий Object-ов бланка

InObject Private

--------------------------------------------------------------------------------
--{ Обработчики событий Object-ов бланка

  функ шаблон_ПриОтмене :Логическое;
    Result = Истина;
  конец;
--------------------------------------------------------------------------------
  proc шаблон_ПриОткрытии(Create :Logical);
    inherited шаблон_ПриОткрытии(Create);

    секПриемник = nil;
    Create      = True;
    фрПриемник  = Template.CurrentFrame;     -- Приемник

  end;
--------------------------------------------------------------------------------
  func CellOnClick(Cell :TemplateCell; Action :Template.ClickTypes) :Logical;
    -- Обработка события нажатия в зависимости от типа
    -- Параметры:
    --   Cell: клетка шаблона
    --   Action: тип нажатия (SingleClick, DoubleClick, EnterPressed, ButtonPressed)
    Result = True; -- Разрешаем стандартную обработку
  end;
--------------------------------------------------------------------------------
  proc BlankOnCreate(Context :Variant);
    -- Вызывается при создании объекта класса
    Create ;
  end;
--------------------------------------------------------------------------------
  func ПолеЗаголовокОкнаФормы_ПриВыводе(Cell :TemplateCell; Value :Variant; Action :Template.OutputTypes; var Format :String) : Строка;
    Если Value="" Тогда
    Илсе;
    Result = inherited ПолеЗаголовокОкнаФормы_ПриВыводе(Cell,
                                                        Value,
                                                        Action,
                                                        Format);
    Если Value="" Тогда
       Value = ЗаголовокОкнаФормы;
    Илсе;
    Result = Value; -- Что получили, то и выводим
  end;

--------------------------------------------------------------------------------
--} Обработчики событий Object-ов бланка

end