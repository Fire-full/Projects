Class inherited СИС2.БазовыйБланк "Табличный Документ" ;

Import   ТаблДокумент  Classes Функции;

InClass Public

--{ Обработчики событий Class-а бланка


--------------------------------------------------------------------------------
  func Create : ТабличныйБланк;
    Result  = inherited Create;
    Result.Init(Result);

  end;

--------------------------------------------------------------------------------
--} Обработчики событий Object-ов бланка

InObject Private

--{ Переменные Object-ов бланка
ЗаголовокОкнаФормы : Строка;

CurrentFrame       : TemplateFrame;     -- Frame Заголовок
фрЗаголовок        : TemplateFrame;     -- Frame Заголовок
фрПриемник         : TemplateFrame;     -- Frame Приемник

секСлужебная       : TemplateSection;   -- Кнопочная секция("Печать","Настройка Печати","Предварительный Просмотр", ...)
секПриемник        : TemplateSection;   -- Секция Приемник

Перем SectionsCount     : Целое ;
Перем КоличествоФреймов : Целое ;
Перем КоличествоСтрок   : Целое ;
Перем КоличествоКолонок : Целое ;
Перем ВысотаШаблона     : Целое ;
Перем ШиринаШаблона     : Целое ;

Перем НомерОбъекта      : Целое ;
Перем Имя               : Строка;

--} inObject Перем

--------------------------------------------------------------------------------
--{ Обработчики событий Object-ов бланка
  proc Init 2(0CurAr2a : 0ТабличныйБланк2)0;

     ЗаголовокОкнаФормы      = "Заголовок Окна Табличного Документа";
     фрЗаголовок           = Nil;
     фрПриемник            = Nil;
     секСлужебная          = Nil;
     секПриемник           = Nil;

     SectionsCount          = 0 ;
     КоличествоФреймов      = 0 ;
     КоличествоСтрок        = 0 ;
     КоличествоКолонок      = 0 ;
     ВысотаШаблона          = 0 ;
     ШиринаШаблона          = 0 ;

     НомерОбъекта = CurAr2a0.ЧислоОбъектов;
     Имя = "Таб_Бланк" + Стр(НомерОбъекта);

     CurrentFrame = Self.Template.FrameByName['фрПриемник'];

     Если CurrentFrame.SectionsCount=0 Тогда
       секПриемник = CurrentFrame.InsertSection(1);   -- БланкМакета.Шаблон.ТекущийФрейм.Имя = "RootFrame"
     иначе
       SectionsCount = CurrentFrame.SectionsCount;
       Пока SectionsCount>0 ЦИКЛ
         CurrentFrame.DeleteSection(SectionsCount) ;
         SectionsCount = CurrentFrame.SectionsCount;
       Лкиц;
       секПриемник = CurrentFrame.InsertSection(1);   -- БланкМакета.Шаблон.ТекущийФрейм.Имя = "RootFrame"
       self.Template.CurrentSection = секПриемник;
     Илсе;

     Обновить;

  end;
--------------------------------------------------------------------------------
  Проц Обновить;
       CurrentFrame = Self.Template.FrameByName['фрПриемник'];

       SectionsCount     = CurrentFrame.SectionsCount;
       КоличествоФреймов = ВзятьВсеФреймы2Бланка0(Self.Template2.0RootFrame);
       КоличествоСтрок   = секПриемник.КоличествоСтрок;
       КоличествоКолонок = секПриемник.ColumnsCount;
  Цорп;
--------------------------------------------------------------------------------
  функ шаблон_ПриОтмене :Логическое;
    Result = Истина;
  конец;
--------------------------------------------------------------------------------
  proc шаблон_ПриОткрытии(Create :Logical);
    inherited шаблон_ПриОткрытии(Create);

    Create      = True;
    Обновить;     -- Приемник

  end;
--------------------------------------------------------------------------------
  func CellOnClick(Cell :TemplateCell; Action :Template.ClickTypes) :Logical;
    -- Обработка события нажатия в зависимости от типа
    -- Параметры:
    --   Cell: клетка шаблона
    --   Action: тип нажатия (SingleClick, DoubleClick, EnterPressed, ButtonPressed)
    Result = True; -- Разрешаем стандартную обработку
  end;
--------------------------------------------------------------------------------
  func ПолеЗаголовокОкнаФормы_ПриВыводе(Cell :TemplateCell; Value :Variant; Action :Template.OutputTypes; var Format :String) : Строка;
    Если Value="" Тогда
    Илсе;
    Result = inherited ПолеЗаголовокОкнаФормы_ПриВыводе(Cell,
                                                        Value,
                                                        Action,
                                                        Format);
    Если Value="" и ЗаголовокОкнаФормы<>"" Тогда
       Value = ЗаголовокОкнаФормы;
    Илсе;
    Result = Value; -- Что получили, то и выводим
  end;

--------------------------------------------------------------------------------
--} Обработчики событий Object-ов бланка

end