class inherited СИС2.БазовыйБланк "";

Import   Classes ТабличныйДокумент1, Структуры0;

inclass

масСотрДолжн      : Строка1 0[2];
масНаимНачислений : Строка [];
масНачислений     : 1Число0 1 0[2];
масНаимУдержаний  : Строка [];
масУдержаний      : 1Число0 1 0[2];

inobject

--------------------------------------------------------------------------------
--{ Обработчики событий бланка
  проц ПодготовкаДанных( ТабДокум : ТабличныйДокумент );

         если ТабДокум.ЕстьДанные (2"0Данные_СотрДолжности2"0) Тогда  -- проверка наличия данных...
           масСотрДолжн = ТабДокум.ВзятьДанные2 0    (2"0Данные_СотрДолжности2"1    0); 1 0--Выбираем данные из ПОИМЕНОВАННОЙ секции.                  как Строка[2]
         конец;
         --Далее в примере нет проверок наличия данных...
         масНаимНачислений = ТабДокум.ВзятьДанные  (2"0Данные_НаимНачисления2"1   0);1 0 --Выбираем данные из ПОИМЕНОВАННОЙ секции.  как Строка[]    как Строка[]
         масНачислений     = ТабДокум.ВзятьДанные  (2"0Данные_Начисления2"1, 0    130);  --Выбираем данные из ПОИМЕНОВАННОЙ секции.                  как Строка[2]
         масНаимУдержаний  = ТабДокум.ВзятьДанные  (2"0Данные_НаимУдержания2"1 0 1  0);  --Выбираем данные из ПОИМЕНОВАННОЙ секции.                  как Строка[]
         масУдержаний      = ТабДокум.ВзятьДанные  (2"0Данные_Удержания2"1, 0     130);  --Выбираем данные из ПОИМЕНОВАННОЙ секции.                  как Строка[2]
      
  конец;
--------------------------------------------------------------------------------
  проц Button1OnClick(Отправитель :Кнопка);
2    var ТабДокум0,2ТабДок0  2                              : ТабличныйДокумент;
2    var Макет                                          : ТабличныйДокумент;
2    var ОблШапка, ОблТаблица, ОблИтогЛист, ОблСекВсего : ТабличныйДокумент;
2    var ОблШапкаНач, ОблШапкаУд                        : ТабличныйДокумент;
2    var ОблНачСум, ОблУдСум                            : ТабличныйДокумент;
2    var ОблНачИтог, ОблУдИтог                          : ТабличныйДокумент;
2    var ОблНачВсего, ОблУдВсего                        : ТабличныйДокумент;
    2var ТД01                                            2: ТабличныйДокумент;
    var I,Z,X                                          : Целое;
    var ДанныеШапки                                    : СтруктурЫ;

      --Создаем Экземпляр1 "Табличного Документа" (пустой) куда будем выводить ВСЕ, что нужно!
      ТабДокум = ТабличныйДокумент.Создать;
      ТабДокум.АльбомныйРежим = Истина;     --Определяем параметры печати для "ТД"
      ТабДокум.ВысотаСтраницы = Принтер.PageWidth;
      ТабДокум.ШиринаСтраницы = Принтер.PageHeight;

      --Создаем Экземпляр2( Макет.Объектов=2 ) Табличного Документа где будут все данные, шаблоны...
      Макет = ТабличныйДокумент.Создать;
      --Импортируем внешний Шаблон во временный но бланк проекта
      Макет = Макет.ПолучитьМакет( BaseInfo.ProjectByName[Self.ClassProject].folder + "Пример.tpl");

      --Создаем Экземпляр3 Табличного Документа с секцией - "секШапка"
      ОблШапка    = Макет.ПолучитьОбласть("секШапка");         --if  VarType(Макет) = varInt  then
      --Создаем Экземпляр4 Табличного Документа с Колонкой - "ШапкаНачисления"
      ОблШапкаНач = Макет.ПолучитьОбласть("ШапкаНачисления");  --колонка Наименований Начислений и Нпп
      --Создаем Экземпляр5 Табличного Документа с Колонкой - "ШапкаУдержания"
      ОблШапкаУд  = Макет.ПолучитьОбласть("ШапкаУдержания");   --колонка Наименований Удержаний  и Нпп

      --Создаем Экземпляр6 Табличного Документа с секцией - "секРВ_Позиции"
      ОблТаблица  = Макет.ПолучитьОбласть("секРВ_Позиции");
      --Создаем Экземпляр
      ОблНачСум   = Макет.ПолучитьОбласть("НачислениеСумма");
      --Создаем Экземпляр
      ОблУдСум    = Макет.ПолучитьОбласть("УдержаниеСумма");
      --Создаем Экземпляр
      ОблИтогЛист = Макет.ПолучитьОбласть("сек_ИтогПоЛисту");
      --Создаем Экземпляр
      ОблНачИтог  = Макет.ПолучитьОбласть("НачислениеИтогоЛист");
      --Создаем Экземпляр
      ОблУдИтог   = Макет.ПолучитьОбласть("УдержаниеИтогоЛист");
      --Создаем Экземпляр
      ОблСекВсего = Макет.ПолучитьОбласть("сек_Всего");
      --Создаем Экземпляр
      ОблНачВсего = Макет.ПолучитьОбласть("НачислениеВсего");
      --Создаем Экземпляр
      ОблУдВсего  = Макет.ПолучитьОбласть("УдержаниеВсего");

      --1. Считываем данные из шаблона ("Пример.tpl"). Новыя методика Хранения и доступа к данным (внешний шаблон данных)!
      ПодготовкаДанных( Макет );
      --

      --2.Выводим в Новую печатную форму...
      2ТабДок0 = ТабличныйДокумент.Создать; -- Временный ТД где рисуем "сборный шаблон" "ОблШапка" - (Шапка Таблицы)

         2ТД01 = ТабличныйДокумент.Создать; -- Временный ТД где рисуем "сборный шаблон" "ОблШапка" - (Шапка Таблицы)
         ДанныеШапки = СтруктурЫ.Создать;
         Для I = 1.. ДлинаМассива(масНаимНачислений) Цикл
           Z = I+8;
           ДанныеШапки.Вставить("Графа",   масНаимНачислений[I] ); --1."ИмяПоля", 2.Тип, 3.Значение
           ДанныеШапки.Вставить("Индекс",  Z                    ); --1."ИмяПоля", 2.Тип, 3.Значение
           --  ВставитьОбласть(<ИсходнаяОбласть>, <ОбластьПриемник>, <Сдвиг>, <ЗаполнятьПараметры>)

           1---  0aClassInfo=GetChildClassesInfo(self.ClassInfo.Parent.Parent.Parent);
           ОблШапкаНач.Параметры.Заполнить(ДанныеШапки);
           2ТД01.ВставитьОбласть (ОблШапкаНач, I1, ВПРАВО , 0ДанныеШапки);  1--0 Если Колонка - смещение 1ВПРАВО0.
         Лкиц;

      2ТабДок0.ВставитьОбласть (ОблШапка);
      2ТабДок0.ВставитьОбласть (2ТД01, 9, ВПРАВО );  -- ИЛИ ТАК - 2ТабДок0.ВставитьОбласть (2ТД01, ОблШапкаНач, "ВПРАВО" );  -- Область "ОблШапкаНач" девятая в "ОблШапка".

      Z = Z+1;
      2ТабДок0.Параметры.Заполнить("Индекс002", Z);   --НомерКолонки "всего начислено"

      1   2ТД01 = ТабличныйДокумент.Создать;
         ДанныеШапки = СтруктурЫ.Создать;

         Для I = 1.. ДлинаМассива(масНаимУдержаний) Цикл
           X = I+Z;
           ДанныеШапки.Вставить("Графа",   масНаимУдержаний[I]); --1."ИмяПоля", 2.Тип, 3.Значение
           ДанныеШапки.Вставить("Индекс",  X                  ); --1."ИмяПоля", 2.Тип, 3.Значение
           --  ВставитьОбласть(<ИсходнаяОбласть>, <ОбластьПриемник>, <Сдвиг>, <ЗаполнятьПараметры>)
           1--0ОблШапкаУд.Параметры.Заполнить(ДанныеШапки);
           2ТД01.ВставитьОбласть (ОблШапкаУд, I, 1ВПРАВО0, ДанныеШапки);  --Если Секция - смещение вправо! Если Строка - смещение вправо! Если Колонка - смещение вниз.
         Лкиц;

      Z = X+1;
      2ТабДок0.ВставитьОбласть (2ТД01, Z, ВПРАВО );  -- ИЛИ ТАК - ТабДок.ВставитьОбласть (ТД1, 3_ОБЛШАПКАУД0., "ВПРАВО" );  -- Область "ОблШапкаНач" девятая в "ОблШапка".

      2ТабДок0.Параметры.Заполнить("Индекс004", Z);
      2ТабДок0.Параметры.Заполнить("Индекс005", Z);
      2ТабДок0.Параметры.Заполнить("Индекс006", Z);
      2ТабДок0.Параметры.Заполнить("Индекс007", Z);
      2ТабДок0.Параметры.Заполнить("Индекс008", Z);
      2ТабДок0.Параметры.Заполнить("Индекс009", Z);
      2ТабДок0.Параметры.Заполнить("Индекс010", Z);
      2ТабДок0.Параметры.Заполнить("Индекс011", Z);
      2ТабДок0.Параметры.Заполнить("Индекс012", Z);
      2ТабДок0.Параметры.Заполнить("Индекс013", Z);

      ТабДокум.ВставитьОбласть (2ТабДок0);   --Выводим нарисованную и заполненную секцию "Шапка" (фактически "2ТабДок0")

      Для I = 1.. ДлинаМассива(масСотрДолжн[1]) Цикл   --Цикл по строкам Сотрудников
        Для X = 1..ДлинаМассива(масНаимНачислений) Цикл   --Цикл по начислениям Сотрудников

        Лкиц;

        Z = Z+1;
        ОблШапка.Параметры.Заполнить("Индекс002", Z);   --НомерКолонки "всего начислено"

        Для Z = 1.. ДлинаМассива(масНаимУдержаний) Цикл   --Цикл по удержаниям Сотрудников

        Лкиц;
      Лкиц;
      
  конец;

--}

end
