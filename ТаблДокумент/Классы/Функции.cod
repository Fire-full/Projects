class "Функции";

Import ТаблДокумент  Classes ТабличныйДокумент ;

inclass

  -------------------------------------------------
  func ИзСтроки                            (aVarType : Integer;      aValue :Variant ) :Variant;

      if aValue in [Nil, ""]  then
        aValue = Nil ;
      end;

      if (aVarType = varString) then
         Result = aValue;
            if Result = nil then
              Сообщение("Не верное 2приведение к0 тип2у0 данных!" + "[Строка<>"+ ВСтр(aValue)+"]");
            end;
      elsif (aVarType = varInt) then
2          Попытка
            if aValue in [Nil, ""] then
              Result = Int (Nil);
            Иначе
              Result = Int (aValue);
            end;
          Исключение
              Сообщение("Не верное 2приведение к0 тип2у0 данных!" + "[Целое<>"+ ВСтр(aValue)+"]");
          2К0онец;
      elsif (aVarType = varNumeric) then
2          Попытка
            if aValue in [Nil, ""] then
              Result = КакЧисло (Nil);
            Иначе
              Result = КакЧисло (aValue);
            end;
          Исключение
              Сообщение("Не верное 2приведение к0 тип2у0 данных!" + "[Число<>"+ ВСтр(aValue)+"]");
          2К0онец;
      elsif (aVarType = varLogical) then
            Result = (Up(aValue) = 'TRUE') or (Up(aValue) = 'ИСТИНА') or (Up(aValue) = '1');
      elsif (aVarType = varDate) then
2          Попытка
            if aValue in [Nil, ""] then
              Result = StringToDate(Nil);
            Иначе
              Result = StringToDate(aValue);
            end;
          Исключение
              Сообщение("Не верное 2приведение к0 тип2у0 данных!" + "[Дата<>"+ ВСтр(aValue)+"]");
          2К0онец;
      end;
  end;
  -------------------------------------------------
  Функ ВзятьВсеФреймы2Бланка0   (TempSec:2 0ФреймШаблона2; 0var2 arr0Temp2 0: ФреймШаблона2[] = Nil0) :Целое;
    var j,N    : Integer;
      Если TempSec=2Nil0 Тогда
      2Иначе
        N=TempSec.FramesCount;                         -- Кол. Фреймов в бланке
        Если N=200 и ДлинаМассива(Фреймы)=0 Тогда        -- Кол. Фреймов в бланке2 = 0.0 RootFrame2!
           ВставитьВМассив (2arr0Temp, 1 , TempSec );
        2Иначе
           for j= 1..  N  do                             -- Цикл по Фреймам бланка
             ВставитьВМассив (2arr0Temp, ДлинаМассива(2arr0Temp)+1 , TempSec.Frame[j] );
             ВзятьВсеФреймы2Бланка0 (TempSec.Frame[j]2, arr0Temp);
           end;
        Илсе;
      Илсе;

    Результат = ДлинаМассива(2arr0Temp);
  Кнуф;
  -------------------------------------------------
  func ВернутьВысотуСтрок     (sec:section) : integer;
    var j,i,f, rowscount : integer;
    var Sect : TemplateSection;
    var ФреймШаблонаПолучателя : Template;
      result = 0;
      ФреймШаблонаПолучателя = sec.Owner;
        f = ФреймШаблонаПолучателя.SectionsCount;  --Текущий Фрейм
        for i = 1 .. f do
          Sect = ФреймШаблонаПолучателя.Section[i] ;
          rowscount = Sect.rowscount;
          for j = 1 .. rowscount do
            result = result + int(Sect.row[j].height);
          end;
        end;
  end;
  -------------------------------------------------
  func ВернутьШиринуСтолбцов  (аСекция:section) : integer;
    var i :integer;
      result = 0;
      if аСекция.ColumnsCount > 0 then
         for i = 1 .. аСекция.ColumnsCount do
           result = result + int(аСекция.column[i].width);
         end;
      end;
  end;
  -------------------------------------------------

inobject

end